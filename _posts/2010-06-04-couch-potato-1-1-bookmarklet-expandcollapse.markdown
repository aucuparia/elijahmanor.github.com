---
layout: post
title: Couch Potato 1.1 Bookmarklet – Expand/Collapse
date: '2010-06-04 16:55:00'
---

<p><a href="http://rookery9.aviary.com.s3.amazonaws.com/4146000/4146293_ac8f.png"><img title="4146293_ac8f" border="0" alt="4146293_ac8f" src="http://elijahmanor.com/webdevdotnet/image.axd?picture=4146293_ac8f_thumb.png" width="604" height="378"></a> </p>  <p>I updated the Couch Potato bookmarklet to add the ability to expand and collapse the details of each document from the list page by clicking the “+” to the left of the document key.</p>  <p>You can also click the “Expand All Documents” action located in the right navigation column.</p>  <h4>The Bookmarklet</h4>  <p>To use the bookmarklet, drag the following link to your bookmark/favorites list:</p>  <p>» <a href="javascript:(function(e,a,g,h,f,c,b,d)%7Bif(!(f=e.jQuery)%7C%7Cg%3Ef.fn.jquery%7C%7Ch(f))%7Bc=a.createElement('script');c.type='text/javascript';c.src='http://ajax.googleapis.com/ajax/libs/jquery/'+g+'/jquery.min.js';c.onload=c.onreadystatechange=function()%7Bif(!b&&(!(d=this.readyState)%7C%7Cd=='loaded'%7C%7Cd=='complete'))%7Bh((f=e.jQuery).noConflict(1),b=1);f(c).remove()%7D%7D;a.documentElement.childNodes%5B0%5D.appendChild(c)%7D%7D)(window,document,'1.3.2',function(%24,L)%7B%24('#nav').append(%22%3Cli%3E%3Cspan%3EActions%3C/span%3E%3Cul%3E%3Cli%3E%3Ca%20id='selectAllDocuments'%3ESelect%20All%20Documents%3C/a%3E%3C/li%3E%3Cli%3E%3Ca%20id='deleteDocuments'%3EDelete%20Documents%3C/a%3E%3C/li%3E%3Cli%3E%3Ca%20id='expandAllDocuments'%3EExpand%20All%20Documents%3C/a%3E%3C/li%3E%3Cli%3E%3Ca%20id='collapseAllDocuments'%3ECollapse%20All%20Documents%3C/a%3E%3C/li%3E%3C/ul%3E%3C/li%3E%22);%24('%23selectAllDocuments').click(function()%7Bvar%20a=%24('%23documents%20tbody%20tr%20.deleteRow:not(:checked)');%24.each(a,function(b,c)%7Bvar%20d=%24(this).parents('tr');var%20e=d.find('td.key%20strong').text().replace(/%22/g,'');if(e.indexOf('_design/')===-1)%7B%24(c).attr('checked',true)%7D%7D)%7D);%24('%23deleteDocuments').click(function()%7Bvar%20a=%24('%23documents%20tbody%20tr%20.deleteRow:checked');var%20b=confirm('Are%20you%20sure%20you%20want%20to%20delete%20'+a.length+'%20documents?');if(b)%7B%24.each(a,function(d,e)%7Bvar%20f=%24(this).parents('tr');var%20g=f.find('td.key%20strong').text().replace(/%22/g,'');var%20c=f.find('td.value%20.string').text().replace(/%22/g,'');deleteDocument(g,c,f)%7D)%7D%7D);%24('%23expandAllDocuments').click(function()%7B%24('%23documents%20tbody%20tr%20td.key%20.toggle').text('+').trigger('click')%7D);%24('%23collapseAllDocuments').click(function()%7B%24('%23documents%20tbody%20tr%20td.key%20.toggle').text('-').trigger('click')%7D);%24('%23documents%20thead%20tr').append('%3Cth%3E%3Cspan%3EDelete%3C/span%3E%3C/th%3E');%24('%23documents%20tbody%20tr').append(%22%3Ctd%3E%3Cinput%20class='deleteRow'%20type='checkbox'%20/%3E%3C/td%3E%22);%24('%23documents%20tbody%20tr:last%20td:last').remove();function%20deleteDocument(d,a,c)%7Bvar%20b=new%20%24.futon.CouchDocumentPage();b.db.removeDoc(%7B_id:d,_rev:a%7D,%7Bsuccess:function(e)%7Bc.find('td').css('background-color','%23F4A8A4')%7D%7D)%7Dfunction%20getDocument(c,b)%7Bvar%20a=new%20%24.futon.CouchDocumentPage();a.db.openDoc(c,%7Berror:function(d,e,f)%7Bb(false,doc)%7D,success:function(d)%7Bb(true,d)%7D%7D)%7D%24('%23documents%20tbody%20tr%20td.key').each(function(a,b)%7B%24(b).find('a').css('display','inline');%24(b).prepend(%24(%22%3Cspan%20class='toggle'%20style='padding-right:%205px;%20cursor:%20pointer;'%3E+%3C/span%3E%22).click(function()%7Bvar%20d=%24(this).text();if(d==='+')%7Bif(%24(this).parents('tr').next().hasClass('preview'))%7B%24(this).parents('tr').next().fadeIn('slow')%7Delse%7Bvar%20e=%24(b).find('strong').text().replace(/%22/g,'');var%20c=%24(%22%3Ctr%20class='preview'%3E%3Ctd%20colspan='2'%3E%3Cpre%20style='white-space:%20pre-wrap;%20white-space:%20-moz-pre-wrap;%20white-space:%20-pre-wrap;%20white-space:%20-o-pre-wrap;%20word-wrap:%20break-word;'%3ELoading...%3C/pre%3E%3C/td%3E%3Ctd%3E%C2%A0%3C/td%3E%3C/tr%3E%22).insertAfter(%24(this).parents('tr'));getDocument(e,function(g,f)%7Bc.find('td%20pre').html(%24.futon.formatJSON(f,%7Bhtml:true%7D))%7D)%7D%7Delse%7B%24(this).parents('tr').next().fadeOut('slow')%7D%24(this).text(%24(this).text()==='+'?'-':'+')%7D))%7D);%7D);">Couch Potato 1.1</a> «</p>