---
layout: post
title: Couch Potato Bookmarklet – Lazy Features for CouchDB’s Futon
date: '2010-05-28 13:52:00'
---

<h4>The Problem</h4>  <p>We’ve been using CouchDB in our current project at work and I’ve been using the CouchDB Futon manager more and more lately to create, edit, or delete documents.</p>  <p><a href="http://elijahmanor.com/webdevdotnet/image.axd?picture=FutonBeforeDropShadow.jpg"><img title="FutonBeforeDropShadow" border="0" alt="FutonBeforeDropShadow" src="http://elijahmanor.com/webdevdotnet/image.axd?picture=FutonBeforeDropShadow_thumb.jpg" width="628" height="422"></a> </p>  <p>After a lot of test data gets into our document store, I end up needing to clear out the documents. I could Delete the whole database with a button, but I’d rather not remove the CouchDB design documents defining custom views. </p>  <p>In order to delete documents from Futon, you have to manually drill down into each document and then click the delete button. I found this very monotonous, so I decided to make a bookmarklet to help me out some.</p>  <h4>The Solution</h4>  <p>So, I created the CouchDB Potato Bookmarklet (because I’m lazy). The bookmarklet creates a new delete column and provides a “Delete Documents” link to delete all the checked documents. I also added a “Select All Documents” which only selects non-design documents (so that I don’t accidentally delete a CouchDB view). These links can be found in the right navigation column under the “Recent Databases” section.</p>  <p><a href="http://elijahmanor.com/webdevdotnet/image.axd?picture=FutonAfterDropShadow.jpg"><img title="FutonAfterDropShadow" border="0" alt="FutonAfterDropShadow" src="http://elijahmanor.com/webdevdotnet/image.axd?picture=FutonAfterDropShadow_thumb.jpg" width="628" height="422"></a> </p>  <h4>The Bookmarklet</h4>  <p>To use the bookmarklet, drag the following link to your bookmark/favorites list:</p>  <p>» <a href="javascript:(function(e,a,g,h,f,c,b,d)%7Bif(!(f=e.jQuery)%7C%7Cg%3Ef.fn.jquery%7C%7Ch(f))%7Bc=a.createElement('script');c.type='text/javascript';c.src='http://ajax.googleapis.com/ajax/libs/jquery/'+g+'/jquery.min.js';c.onload=c.onreadystatechange=function()%7Bif(!b&&(!(d=this.readyState)%7C%7Cd=='loaded'%7C%7Cd=='complete'))%7Bh((f=e.jQuery).noConflict(1),b=1);f(c).remove()%7D%7D;a.documentElement.childNodes%5B0%5D.appendChild(c)%7D%7D)(window,document,'1.3.2',function(%24,L)%7B%24('#nav').append(%22%3Cli%3E%3Cspan%3EActions%3C/span%3E%3Cul%3E%3Cli%3E%3Ca%20id='selectAllDocuments'%3ESelect%20All%20Documents%3C/a%3E%3C/li%3E%3Cli%3E%3Ca%20id='deleteDocuments'%3EDelete%20Documents%3C/a%3E%3C/li%3E%3C/ul%3E%3C/li%3E%22);%24('%23selectAllDocuments').click(function()%7Bvar%20a=%24('%23documents%20tbody%20tr%20.deleteRow:not(:checked)');%24.each(a,function(b,c)%7Bvar%20d=%24(this).parents('tr');var%20e=d.find('td.key%20strong').text().replace(/%22/g,'');if(e.indexOf('_design/')===-1)%7B%24(c).attr('checked',true)%7D%7D)%7D);%24('%23deleteDocuments').click(function()%7Bvar%20a=%24('%23documents%20tbody%20tr%20.deleteRow:checked');var%20b=confirm('Are%20you%20sure%20you%20want%20to%20delete%20'+a.length+'%20documents?');if(b)%7B%24.each(a,function(d,e)%7Bvar%20f=%24(this).parents('tr');var%20g=f.find('td.key%20strong').text().replace(/%22/g,'');var%20c=f.find('td.value%20.string').text().replace(/%22/g,'');deleteDocument(g,c,f)%7D)%7D%7D);%24('%23documents%20thead%20tr').append('%3Cth%3E%3Cspan%3EDelete%3C/span%3E%3C/th%3E');%24('%23documents%20tbody%20tr').append(%22%3Ctd%3E%3Cinput%20class='deleteRow'%20type='checkbox'%20/%3E%3C/td%3E%22);%24('%23documents%20tbody%20tr:last%20td:last').remove();function%20deleteDocument(d,a,c)%7Bvar%20b=new%20%24.futon.CouchDocumentPage();b.db.removeDoc(%7B_id:d,_rev:a%7D,%7Bsuccess:function(e)%7Bc.find('td').css('background-color','%23F4A8A4')%7D%7D)%7D;%7D);">Couch Potato</a> «</p>  <p>Then, when you're on a listing page in Futon, just click the bookmarklet.</p>  <h4>Ideas for Future Development</h4>  <p>I’ve considered adding some more functionality to Couch Potato such as</p>  <ul><li>Converting it into a GreaseMonkey script (Google Chrome & Firefox) </li>    <li>Add tooltips to the document rows showing the details of the stored document </li> </ul><p>Do you have any ideas you’d like to see?</p>